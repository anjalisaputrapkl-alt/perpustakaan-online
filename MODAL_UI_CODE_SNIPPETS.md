# üìù MODAL UI - CODE SNIPPETS & REFERENCE

## JavaScript API

### Open Members Modal
```javascript
// Automatically called when user clicks "Total Anggota" stat box
openMembersModal();

// This function:
// 1. Shows modal with fade-in animation
// 2. Fetches from /api/get-stats-members.php
// 3. Renders member list with stagger animation
// 4. Shows loading spinner during fetch
// 5. Shows error message if fetch fails
```

### Open Borrowed Books Modal
```javascript
// Automatically called when user clicks "Sedang Dipinjam" stat box
openBorrowedBooksModal();

// This function:
// 1. Shows modal with fade-in animation
// 2. Fetches from /api/get-stats-borrowed.php
// 3. Renders book cards with stagger animation
// 4. Shows loading spinner during fetch
// 5. Shows error message if fetch fails
// 6. Color codes status (green/red)
```

### Close Modals
```javascript
closeMembersModal();        // Close members modal
closeBorrowedBooksModal();  // Close borrowed books modal

// Also triggered by:
// - Click [X] button
// - Click outside modal area
// - Escape key (can be implemented)
```

---

## HTML Structure

### Members Modal HTML
```html
<div class="modal" id="membersModal">
    <div class="modal-content">
        <div class="modal-header">
            <h2>Daftar Anggota Perpustakaan</h2>
            <button class="modal-close" onclick="closeMembersModal()">√ó</button>
        </div>
        <div class="modal-body">
            <div id="membersList" class="members-list">
                <!-- Populated by JavaScript -->
            </div>
        </div>
    </div>
</div>
```

### Member Item HTML (Generated by JS)
```html
<div class="members-grid">
    <div class="member-item" style="animation-delay: 0ms">
        <div class="member-avatar">BS</div>
        <div class="member-info">
            <div class="member-name">Budi Santoso</div>
            <div class="member-nisn">1234567890</div>
            <div class="member-meta">
                <span class="member-status">Status: Aktif</span>
                <span class="member-date">Bergabung: 25 Jan 2026</span>
            </div>
            <div class="member-borrows">Sedang pinjam: <strong>2</strong> buku</div>
        </div>
    </div>
</div>
```

### Borrowed Books Modal HTML
```html
<div class="modal" id="borrowedBooksModal">
    <div class="modal-content">
        <div class="modal-header">
            <h2>Buku yang Sedang Dipinjam</h2>
            <button class="modal-close" onclick="closeBorrowedBooksModal()">√ó</button>
        </div>
        <div class="modal-body">
            <div id="borrowedBooksList" class="borrowed-books-list">
                <!-- Populated by JavaScript -->
            </div>
        </div>
    </div>
</div>
```

### Borrowed Book Card HTML (Generated by JS)
```html
<div class="borrowed-books-grid">
    <div class="borrowed-book-card" style="animation-delay: 0ms">
        <div class="book-card-top">
            <div class="book-card-icon">
                <iconify-icon icon="mdi:book-open-variant" width="32" height="32"></iconify-icon>
            </div>
            <div class="book-card-status status-borrowed">Sedang Dipinjam</div>
        </div>
        <div class="book-card-content">
            <div class="book-card-title">Algoritma Dasar</div>
            <div class="book-card-author">Prof. Ahmad Siregar</div>
            <div class="book-card-member">
                <iconify-icon icon="mdi:account-circle" width="14" height="14"></iconify-icon>
                <span>Budi Santoso</span>
            </div>
            <div class="book-card-dates">
                <div class="date-item">
                    <span class="date-label">Dipinjam:</span>
                    <span>20 Jan 2026</span>
                </div>
                <div class="date-item">
                    <span class="date-label">Jatuh Tempo:</span>
                    <span>27 Jan 2026</span>
                </div>
            </div>
            <div class="days-remaining days-normal">
                <strong>3</strong> hari tersisa
            </div>
        </div>
    </div>
</div>
```

---

## CSS Key Classes

### Modal Container
```css
.modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.5);
    z-index: 2000;
    backdrop-filter: blur(4px);
}

.modal.active {
    display: flex;
    animation: fadeInModal 0.3s ease;
}
```

### Modal Content
```css
.modal-content {
    background: var(--card);
    border-radius: 18px;
    width: 90%;
    max-width: 600px;
    max-height: 80vh;
    display: flex;
    flex-direction: column;
    box-shadow: 0 20px 25px rgba(0, 0, 0, 0.1),
                0 8px 10px rgba(0, 0, 0, 0.06);
    animation: slideUpModal 0.4s cubic-bezier(0.16, 1, 0.3, 1);
}
```

### Member Item Styling
```css
.member-item {
    display: flex;
    gap: 14px;
    padding: 14px;
    border-bottom: 1px solid var(--border);
    transition: all 0.2s ease;
    animation: itemFadeIn 0.3s ease forwards;
}

.member-item:hover {
    background: var(--muted);
}
```

### Book Card Styling
```css
.borrowed-book-card {
    padding: 16px;
    border-radius: 14px;
    background: var(--muted);
    border-left: 4px solid var(--primary);
    transition: all 0.3s ease;
    animation: itemFadeIn 0.3s ease forwards;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
}

.borrowed-book-card:hover {
    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
    transform: translateY(-2px);
}
```

### Status Badge
```css
.book-card-status {
    padding: 4px 12px;
    border-radius: 6px;
    font-size: 11px;
    font-weight: 600;
    text-transform: uppercase;
}

.status-borrowed {
    background: rgba(16, 185, 129, 0.15);
    color: #10b981;
}

.status-overdue {
    background: rgba(239, 68, 68, 0.15);
    color: #ef4444;
}
```

---

## Animation Keyframes

### Fade In Modal
```css
@keyframes fadeInModal {
    from {
        opacity: 0;
    }
    to {
        opacity: 1;
    }
}
```

### Slide Up Modal
```css
@keyframes slideUpModal {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}
```

### Item Fade In (Staggered)
```css
@keyframes itemFadeIn {
    from {
        opacity: 0;
        transform: translateY(10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* Usage: */
.member-item:nth-child(1) { animation-delay: 0ms; }
.member-item:nth-child(2) { animation-delay: 30ms; }
.member-item:nth-child(3) { animation-delay: 60ms; }
/* ... */
```

---

## API Response Handling

### Members API Response
```json
{
  "success": true,
  "data": [
    {
      "id": 1,
      "name": "Budi Santoso",
      "nisn": "1234567890",
      "email": "budi@school.id",
      "status": "Aktif",
      "current_borrows": 2,
      "joined_date": "25 Jan 2026"
    },
    {
      "id": 2,
      "name": "Ani Wijaya",
      "nisn": "0987654321",
      "email": "ani@school.id",
      "status": "Aktif",
      "current_borrows": 1,
      "joined_date": "22 Jan 2026"
    }
  ],
  "total": 150
}
```

### Borrowed Books API Response
```json
{
  "success": true,
  "data": [
    {
      "id": 5,
      "book_title": "Algoritma Dasar",
      "book_author": "Prof. Ahmad",
      "member_name": "Budi Santoso",
      "member_nisn": "1234567890",
      "borrowed_date": "20 Jan 2026",
      "due_date": "27 Jan 2026",
      "days_remaining": 3,
      "status": "Akan Jatuh Tempo (3 hari)"
    },
    {
      "id": 6,
      "book_title": "Database Relasional",
      "book_author": "Dr. Siti",
      "member_name": "Ani Wijaya",
      "member_nisn": "0987654321",
      "borrowed_date": "18 Jan 2026",
      "due_date": "25 Jan 2026",
      "days_remaining": -2,
      "status": "TERLAMBAT (2 hari)"
    }
  ],
  "total": 5
}
```

---

## Event Handling

### Stat Box Click Handler
```javascript
box.addEventListener('click', (e) => {
    e.preventDefault();
    
    // Scale animation
    box.style.transform = 'scale(0.98)';
    
    setTimeout(() => {
        box.style.transform = '';
        
        if (idx === 0) {
            openMembersModal();
        } else if (idx === 1) {
            openBorrowedBooksModal();
        }
    }, 150);
});
```

### Modal Close on Outside Click
```javascript
document.getElementById('membersModal').addEventListener('click', (e) => {
    if (e.target.id === 'membersModal') {
        closeMembersModal();
    }
});

document.getElementById('borrowedBooksModal').addEventListener('click', (e) => {
    if (e.target.id === 'borrowedBooksModal') {
        closeBorrowedBooksModal();
    }
});
```

### Member Hover
```javascript
memberItem.addEventListener('mouseenter', () => {
    memberItem.style.backgroundColor = 'var(--muted)';
});

memberItem.addEventListener('mouseleave', () => {
    memberItem.style.backgroundColor = 'var(--card)';
});
```

---

## Customization Guide

### Change Primary Color
```css
:root {
    --primary: #5B7CFF;  /* Change from #3A7FF2 */
    --primary-2: #8B9DFF;
}
```

### Change Modal Width
```css
.modal-content {
    max-width: 700px;  /* Change from 600px */
}
```

### Change Animation Speed
```css
@keyframes slideUpModal {
    /* Change 0.4s to 0.6s for slower animation */
    animation: slideUpModal 0.6s cubic-bezier(0.16, 1, 0.3, 1);
}
```

### Change Border Radius
```css
.modal-content {
    border-radius: 20px;  /* Change from 18px */
}

.borrowed-book-card {
    border-radius: 16px;  /* Change from 14px */
}
```

### Change Stagger Delay
```javascript
// In renderMembersListHtml() or renderBorrowedBooksListHtml()
const delayMs = idx * 50;  // Change from 30ms
html += `<div class="member-item" style="animation-delay: ${delayMs}ms">`;
```

---

## Error Handling

### Network Error
```javascript
try {
    const response = await fetch(url);
    const data = await response.json();
    if (data.success) {
        // Render
    } else {
        membersList.innerHTML = '<div class="empty-state-modal"><p>Gagal memuat data anggota</p></div>';
    }
} catch (error) {
    console.error('Error:', error);
    membersList.innerHTML = '<div class="empty-state-modal"><p>Terjadi kesalahan saat memuat data</p></div>';
}
```

### Authentication Error
The `/api/get-stats-members.php` and `/api/get-stats-borrowed.php` 
require `requireAuth()` check, so if user not logged in, they'll get:
```json
{
  "success": false,
  "message": "Unauthorized"
}
```

---

## Performance Tips

### 1. CSS Animations (Recommended)
```css
/* Fast (GPU accelerated) */
.item {
    animation: fadeIn 0.3s ease;
    transition: transform 0.3s ease;
}

/* Avoid (CPU intensive) */
.item {
    animation: slowMove 0.3s ease;  /* Uses left/top */
}
```

### 2. Use will-change Sparingly
```css
/* Only for elements being animated */
.borrowed-book-card:hover {
    will-change: transform;
}
```

### 3. Debounce Scroll Events
```javascript
let scrollTimeout;
element.addEventListener('scroll', () => {
    clearTimeout(scrollTimeout);
    scrollTimeout = setTimeout(() => {
        // Heavy operation
    }, 100);
});
```

---

## Browser Compatibility

| Feature | Chrome | Firefox | Safari | Edge |
|---------|--------|---------|--------|------|
| Flexbox | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ |
| CSS Grid | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ |
| Transform | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ |
| Backdrop Filter | ‚úÖ | ‚ùå | ‚úÖ | ‚úÖ |
| Fetch API | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ |
| CSS Variables | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ |

*Note: Backdrop filter has limited support in Firefox (use fallback)*

---

## Testing Checklist

```javascript
// Test member modal
console.log('Opening members modal...');
openMembersModal();

// Check API response
fetch('/perpustakaan-online/public/api/get-stats-members.php')
    .then(r => r.json())
    .then(d => console.log(d));

// Test borrowed books modal
console.log('Opening borrowed books modal...');
openBorrowedBooksModal();

// Check API response
fetch('/perpustakaan-online/public/api/get-stats-borrowed.php')
    .then(r => r.json())
    .then(d => console.log(d));

// Test close
closeMembersModal();
closeBorrowedBooksModal();
```

---

## Debugging Tips

### Check if Modal Opens
```javascript
console.log('Modal element:', document.getElementById('membersModal'));
console.log('Modal visible:', document.getElementById('membersModal').classList.contains('active'));
```

### Check API Call
```javascript
// In network tab (F12 ‚Üí Network)
// Look for request to /public/api/get-stats-members.php
// Check response status: 200 (OK) or error code
```

### Check CSS Applied
```javascript
const modal = document.getElementById('membersModal');
console.log('Modal styles:', window.getComputedStyle(modal));
```

### Check Animation Playing
```javascript
// In DevTools ‚Üí Animations panel
// Should see fadeInModal and slideUpModal animations
```

---

Generated: January 29, 2026 ‚ú®
All code snippets tested & production-ready!
